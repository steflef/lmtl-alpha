<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Exemples · LMTL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <link href="assets/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="assets/css/docs.css" rel="stylesheet">
    <link href="assets/js/google-code-prettify/prettify.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="assets/ico/favicon.png">

      <!-- Leaflet -->
      <link rel="stylesheet" href="../examples/js/leaflet/0.5.1/leaflet.css" media="screen, projection" />
      <!--[if lte IE 8]><link rel="stylesheet" href="../examples/js/leaflet/0.5.1/leaflet.ie.css" /><![endif]-->
      <script src="../examples/js/leaflet/0.5.1/leaflet-src.js"></script>

      <!-- jQuery -->
      <script src="../examples/js/jquery/1.8.3/jquery.min.js"></script>
      <script src="../examples/js/jquery/jquery.json-2.4.min.js"></script>

      <style type="text/css">
          .map{
              border:1px solid #ccc;
              height: 180px;
          }
      </style>


      <script>
          CM_ATTR = 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                  '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                  'Imagery © <a href="http://cloudmade.com">CloudMade</a>';
          CM_URL = 'http://{s}.tile.cloudmade.com/d4fc77ea4a63471cab2423e66626cbb6/{styleId}/256/{z}/{x}/{y}.png';

          OSM_URL = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
          OSM_ATTR = '&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors';

          STAMEN_ATTR ='Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.';
          STAMEN_TONER_HYBRID_URL = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-hybrid/{z}/{x}/{y}.png';
          STAMEN_TONER_LINES_URL = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lines/{z}/{x}/{y}.png';
          STAMEN_TONER_BACKGROUND_URL = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}.png';
          STAMEN_TONER_LITE_URL = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png';

          LATLNG = [45.528293,-73.59246];
      </script>

  </head>

  <body data-spy="scroll" data-target=".bs-docs-sidebar">

    <!-- Navbar
    ================================================== -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="http://collectifquartier.org/">Collectif Quartier</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="">
                <a href="./index.html">Accueil</a>
              </li>
              <li class="">
                <a href="./go.html">Pour commencer</a>
              </li>
                <li class="active">
                    <a href="./exemples.html">Exemples</a>
                </li>
                <li class="">
                    <a href="./api.html">API</a>
                </li>
              <li class="">
                <a href="./termes.html">Termes d'utilisation</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <header class="jumbotron subhead" id="overview">
        <div class="container">
            <h1>Exemples d'intégration</h1>
            <p class="lead">Visualisation cartographique</p>
        </div>
    </header>

<div class="container">
<h2>Ajouter une carte dans vos projets</h2>
<p>Nous utiliserons la librairie cartographique <a href="http://leafletjs.com/">Leaflet</a> pour cette série d'exemples.
    Il s'agit d'une librairie très performante et le projet est très bien <a href="http://leafletjs.com/reference.html">documenté</a>.
    Plusieurs autres bonnes options sont disponibles dont <a href="http://openlayers.org/">OpenLayers</a>, <a href="http://d3js.org/">D3</a>, <a href="https://maps.google.ca/">Google Maps</a>, etc.
</p>

<p>Nous allons reprendre le <a href="http://leafletjs.com/examples/quick-start.html">tutoriel d'introduction à Leaflet</a> vous permettant d'intégrer une carte dans vos pages Web.</p>

<div id="map" class="map" style="height: 140px"></div>

<h3>Préparer la page Web</h3>

<p>Avant de pouvoir intégrer des cartes sur votre page Web, vous devez suivre ces étapes de préparation:</p>

<ul>
    <li>
        <p>Inclure la référence à la feuille de style de la librairie Leaflet dans la section head de votre document:</p>

        <pre><code> &lt;link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" /&gt;
            &lt;!--[if lte IE 8]&gt;
            &lt;link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" /&gt;
            &lt;![endif]--&gt;
        </code></pre>
    </li>
    <li>
        <p>Inclure la librairie javascript Leaflet:</p>

        <pre><code> &lt;script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"&gt;&lt;/script&gt;
        </code></pre>
    </li>
    <li>
        <p>Ajouter un élément <code>div</code> avec un identifiant unique <code>id</code> à l'endroit où vous désirez intégrer la carte:</p>

        <pre><code> &lt;div id="map"&gt;&lt;/div&gt;
        </code></pre>
    </li>
    <li>
        <p>Assurez-vous que le conteneur cartographique possède bien un style associé à la hauteur de l'élément, par exemple en l'intégrant à un feuille de style ou directement dans la balise ou dans l'entête de la page Web:</p>

        <pre><code class="css">#map { height: 140px; }</code></pre>
    </li>
</ul>

<p>Et voilà! Vous êtes maintenant prêt à initialiser votre carte et accomplir des actions!</p>
<p>Référez-vous à la <a href="http://leafletjs.com/reference.html">documentation</a> de Leaflef pour en savoir plus sur les nombreuses possibilitées de cette librairie!</p>

<hr>
<h3>Fonds cartographiques</h3>
<p>Vous pouvez personnaliser vos fonds cartographiques en utilisant les services d'un distributeurs de tuiles cartographiques ou en créant vos propre fonds de cartes personnalisés via <a href="http://mapbox.com/tilemill/">TileMill</a>.</p>

<p>Par exemple, voici le fond de carte "Toner Lite" des Studios Stamen</p>
<div id="mapLite" class="map"></div>
<br>
<ul>
    <li>
        <p>Ajouter un élément <code>div</code> avec un identifiant unique <code>id</code> à l'endroit où vous désirez intégrer la carte:</p>

        <pre><code>&lt;div id="mapLite" class="map" style="height: 180px"&gt;&lt;/div&gt;</code></pre>
    </li>

    <li>
        <p>Créer une couche cartographique avec L.tileLayer et ajouter le tout à la carte via carte l'option layers</p>
    <pre>
<code>var stamenAttribution ='Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',
    stamen_lite_url = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png';

    lite = L.tileLayer(stamen_lite_url, {attribution: stamenAttribution});

    var mapLite= L.map('mapLite', {
    center: [45.528293,-73.59246],
    zoom: 10,
    layers: [lite]
    });</code>
    </pre>
    </li>
</ul>
<hr>
<h3>Gestionnaire de couches cartographiques</h3>
<div id="mapCtrl" class="map" style="height: 220px"></div>
<br>
<p>Via l'utilisation du contrôleur de gestion de couches L.control.layers:</p><pre><code>var mapCtrl = L.map('mapCtrl', {
    center: LATLNG,
    zoom: 10,
    layers: [osm, hybrid, lines, back, lite]
    });

    var baseLayers = {
    "Open Street Map": osm,
    "Toner Hybrid": hybrid,
    "Toner Lines": lines,
    "Toner Background": back,
    "Toner Lite": lite
    };

    <strong>L.control.layers(baseLayers).addTo(mapCtrl)</strong>;</code></pre>
<hr>
<h3>Carte statique</h3>
<div id="mapStatic" class="map"></div>
<br>
<p>Via l'option zoomControl:false et la désactivation des méthodes doubleClickZoom, etc.:</p><pre><code>// mapStatic ==================
    var mapStatic= L.map('mapStatic', {
    center: LATLNG,
    zoom: 10,
    <strong>zoomControl:false</strong>
    });

    var  staticLayer = L.tileLayer(STAMEN_TONER_LITE_URL, {styleId: 46561, attribution: STAMEN_ATTR});

    <strong>mapStatic.doubleClickZoom.disable();
        mapStatic.dragging.disable();
        mapStatic.scrollWheelZoom.disable();
        mapStatic.touchZoom.disable();</strong>

    mapStatic.addLayer(staticLayer);</code></pre>
<hr>
<h3>Afficher des régions</h3>
<div id="mapRegions" class="map" style="height: 300px"></div>
<br>
<p>Ajout d'une région en provenance de l'API LMTL.</p>
<p>Nous commençons par créer une fonction <strong>onEachFeature</strong> qui se chargera de lire les features geoJson. Cette fonction ajoutera un Popup à notre couche carto qui sera alimenté par les propriétés du Feature sélectionné.</p>
<pre><code>var mapRegions= L.map('mapRegions', {
    center: [45.50,-73.60],
    zoom: 13
    });

    var  regionBaseLayer = L.tileLayer(STAMEN_TONER_HYBRID_URL, {attribution: STAMEN_ATTR}).addTo(mapRegions);

    <strong>onEachFeature</strong> = function(feature, layer) {
    if (feature.properties && feature.properties.nom) {
    var popupContent = "&lt;p&gt;("+feature.id+") " + feature.geometry.type + ", "+feature.properties.nom+"&lt;/p&gt;";
    layer.bindPopup(popupContent);
    }
    }</code></pre>

<p>Ensuite, on ajoute une couche geoJson à notre carte en l'enregistrant sur la fonction déclarée ci-haut. Nous utilisons ici <a href="http://api.jquery.com/jQuery.get/">jQuery.get</a> pour communiquer avec le serveru LMTL.</p>
<pre><code>$.get('../collab_api/regions/3', function(data) {
    $('.result').html(data);
    $("#regionGeoJson").text($.toJSON(data.results.geoJson));

    L.geoJson(data.results.geoJson.features[0], {
    <strong>onEachFeature</strong>: onEachFeature
    }).addTo(mapRegions);
    });</code></pre>

<p>Résultat de la requête:</p>
<pre style="height: 100px;overflow-y: auto;"><code id="regionGeoJson"></code></pre>
<hr>

<h3>Visualisation de lieux</h3>
<div id="mapPlaces" class="map" style="height: 220px"></div>
<br>
<p>Alimentation en lieux à partir de l'API LMTL [datasets/96/places]. Très similaire à l'exemple précédent avec quelques petites <strong>différences</strong> en fonction du type de données.</p>
    <pre><code>var mapPlaces= L.map('mapPlaces', {
        center: [45.50,-73.60],
        zoom: 13
        });

        var  placesBaseLayer = L.tileLayer(STAMEN_TONER_LITE_URL, {attribution: STAMEN_ATTR}).addTo(mapPlaces);

        <strong>onEachPlace</strong> = function(feature, layer) {
        if (feature.properties && feature.properties.<strong>name</strong>) {
        var popupContent = "&lt;p&gt;("+feature.id+") " + feature.geometry.type + ", "+feature.properties.<strong>name</strong>+"&lt;/p&gt;";
        layer.bindPopup(popupContent);
        }
        }

        $.get(<strong>'../collab_api/datasets/96/places'</strong>, function(data) {
        L.geoJson(data.results.geoJson.features, {
        onEachFeature: <strong>onEachPlace</strong>
        }).addTo(mapPlaces);
        });</code></pre>
<hr>

<h3>Utilisation de marqueurs personnalisés</h3>
<div id="mapCategories" class="map" style="height: 220px"></div>
<br>
<p>Marqueurs personnalisés en provenance de l'API LMTL [categories] et alimentation en lieux à partir de [datasets/96/places].
    Introduction de l'action <strong>pointToLayer</strong> de la couche geoJson qui ajoute une itération sur tous les features et qui permet d'ajouter un marqueur personalisé.
    Également l'ocasion d'utiliser le constructeur de marqueur <strong>L.marker</strong>.</p>
    <pre><code>var mapCategories= L.map('mapCategories', {
        center: [45.50,-73.60],
        zoom: 13
        });

        var  mapCategoriesBaseLayer = L.tileLayer(STAMEN_TONER_LITE_URL, {attribution: STAMEN_ATTR}).addTo(mapCategories);

        $.get('../collab_api/categories', function(data) {
        categories = data.results;

        $.get('../collab_api/datasets/96/places', function(data) {
        L.geoJson(data.results.geoJson.features, {

        <strong>pointToLayer</strong>: function (feature, latlng) {
        if(typeof(categories[feature.properties.primary_category_id]) == 'undefined'){
        return  L.marker(latlng,{});
        }
        return <strong>L.marker</strong>(latlng, {icon: L.icon({
        iconUrl: "../collab_api/public/img/icons/"+categories[feature.properties.primary_category_id].i,
        iconSize: [32, 37],
        iconAnchor: [16, 37],
        popupAnchor: [0, -28]
        })
        });
        },

        onEachFeature: onEachPlace
        }).addTo(mapCategories);
        });
        });</code></pre>
<hr>


<h3>Within</h3>
<div id="mapPlacesWithinRegion" class="map" style="height: 220px"></div>
<br>
<p>Lieux en provenance de l'API LMTL [place/within/3]. Utilisation de deux couches dynamiques (lieux & région).</p>
<pre><code>var mapPlacesWithinRegion= L.map('mapPlacesWithinRegion', {
    center: [45.50,-73.60],
    zoom: 13
    });

    var  withinBaseLayer = L.tileLayer(STAMEN_TONER_LITE_URL, {attribution: STAMEN_ATTR}).addTo(mapPlacesWithinRegion);

    $.get('../collab_api/regions/3', function(data) {
    L.geoJson(data.results.geoJson.features, {
    onEachFeature: onEachFeature
    }).addTo(mapPlacesWithinRegion);
    });

    $.get('../collab_api/places/within/3', function(data) {
    L.geoJson(data.results.geoJson.features, {
    onEachFeature: onEachPlace
    }).addTo(mapPlacesWithinRegion);
    });</code></pre>
<hr>


</div>



    <!-- Footer
    ================================================== -->
    <footer class="footer">
      <div class="container">
        <p>Basé sur le design de Twitter Bootstrap par <a href="http://twitter.com/mdo" target="_blank">@mdo</a> et <a href="http://twitter.com/fat" target="_blank">@fat</a>.</p>
        <p>Code licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License v2.0</a>, documentation under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
        <p><a href="http://glyphicons.com">Glyphicons Free</a> licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
<!--        <ul class="footer-links">
          <li><a href="http://blog.getbootstrap.com">Blog</a></li>
          <li class="muted">&middot;</li>
          <li><a href="https://github.com/twitter/bootstrap/issues?state=open">Issues</a></li>
          <li class="muted">&middot;</li>
          <li><a href="https://github.com/twitter/bootstrap/blob/master/CHANGELOG.md">Changelog</a></li>
        </ul>-->
      </div>
    </footer>



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    <!--<script src="assets/js/jquery.js"></script>-->
    <script src="assets/js/bootstrap-transition.js"></script>
    <script src="assets/js/bootstrap-alert.js"></script>
    <script src="assets/js/bootstrap-modal.js"></script>
    <script src="assets/js/bootstrap-dropdown.js"></script>
    <script src="assets/js/bootstrap-scrollspy.js"></script>
    <script src="assets/js/bootstrap-tab.js"></script>
    <script src="assets/js/bootstrap-tooltip.js"></script>
    <script src="assets/js/bootstrap-popover.js"></script>
    <script src="assets/js/bootstrap-button.js"></script>
    <script src="assets/js/bootstrap-collapse.js"></script>
    <script src="assets/js/bootstrap-carousel.js"></script>
    <script src="assets/js/bootstrap-typeahead.js"></script>
    <script src="assets/js/bootstrap-affix.js"></script>

    <script src="assets/js/holder/holder.js"></script>
    <script src="assets/js/google-code-prettify/prettify.js"></script>

    <script src="assets/js/application.js"></script>

    <script>
     $(document).ready(function() {
        // map ==================
        var map = L.map('map').setView(LATLNG, 13);
        L.tileLayer(OSM_URL, {attribution: OSM_ATTR, styleId: 997}).addTo(map);

        // ===================================

        STAMEN_ATTR ='Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.';
        STAMEN_TONER_HYBRID_URL = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-hybrid/{z}/{x}/{y}.png';
        STAMEN_TONER_LINES_URL = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lines/{z}/{x}/{y}.png';
        STAMEN_TONER_BACKGROUND_URL = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}.png';
        STAMEN_TONER_LITE_URL = 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png';

        var osm   = L.tileLayer(OSM_URL, {styleId: 22677, attribution: OSM_ATTR}),
                hybrid  = L.tileLayer(STAMEN_TONER_HYBRID_URL, {styleId: 999,   attribution: STAMEN_ATTR}),
                lines = L.tileLayer(STAMEN_TONER_LINES_URL, {styleId: 46561, attribution: STAMEN_ATTR}),
                back  = L.tileLayer(STAMEN_TONER_BACKGROUND_URL, {styleId: 999,   attribution: STAMEN_ATTR}),
                lite = L.tileLayer(STAMEN_TONER_LITE_URL, {styleId: 46561, attribution: STAMEN_ATTR}),
                categoriea = [];


        // mapLite ==================
        var mapLite= L.map('mapLite', {
            center: [45.528293,-73.59246],
            zoom: 10,
            layers: [lite]
        });

        // mapCtrl ==================
        var mapCtrl = L.map('mapCtrl', {
            center: LATLNG,
            zoom: 10,
            layers: [osm, hybrid, lines, back, lite]
        });

        var baseLayers = {
            "Open Street Map": osm,
            "Toner Hybrid": hybrid,
            "Toner Lines": lines,
            "Toner Background": back,
            "Toner Lite": lite
        };

        L.control.layers(baseLayers).addTo(mapCtrl);
        // ===================================

        // mapStatic ==================
        var mapStatic= L.map('mapStatic', {
            center: LATLNG,
            zoom: 10,
            zoomControl:false
        });

        var  staticLayer = L.tileLayer(STAMEN_TONER_LITE_URL, {styleId: 46561, attribution: STAMEN_ATTR});

        mapStatic.doubleClickZoom.disable();
        mapStatic.dragging.disable();
        mapStatic.scrollWheelZoom.disable();
        mapStatic.touchZoom.disable();

        mapStatic.addLayer(staticLayer);

        // mapRegions ==================
        var mapRegions= L.map('mapRegions', {
            center: [45.50,-73.60],
            zoom: 13
        });

        var  regionBaseLayer = L.tileLayer(STAMEN_TONER_HYBRID_URL, {attribution: STAMEN_ATTR}).addTo(mapRegions);

        onEachFeature = function(feature, layer) {
            if (feature.properties && feature.properties.nom) {
                var popupContent = "<p>("+feature.id+") " + feature.geometry.type + ", "+feature.properties.nom+"</p>";
                layer.bindPopup(popupContent);
            }
        }

        $.get('../collab_api/regions/3', function(data) {
            $('.result').html(data);
            console.log(data);
            $("#regionGeoJson").text($.toJSON(data.results.geoJson));

            L.geoJson(data.results.geoJson.features[0], {
                onEachFeature: onEachFeature
            }).addTo(mapRegions);
        });

        // mapPlaces ==================
        var mapPlaces= L.map('mapPlaces', {
            center: [45.50,-73.60],
            zoom: 13
        });

        var  placesBaseLayer = L.tileLayer(STAMEN_TONER_LITE_URL, {attribution: STAMEN_ATTR}).addTo(mapPlaces);

        onEachPlace = function(feature, layer) {
            if (feature.properties && feature.properties.name) {
                var popupContent = "<p>("+feature.id+") " + feature.geometry.type + ", "+feature.properties.name+"</p>";
                layer.bindPopup(popupContent);
            }
        }

        $.get('../collab_api/datasets/96/places', function(data) {
            L.geoJson(data.results.geoJson.features, {
                onEachFeature: onEachPlace
            }).addTo(mapPlaces);
        });

        // mapCategories ==================
        var mapCategories= L.map('mapCategories', {
            center: [45.50,-73.60],
            zoom: 13
        });

        var  mapCategoriesBaseLayer = L.tileLayer(STAMEN_TONER_LITE_URL, {attribution: STAMEN_ATTR}).addTo(mapCategories);

        $.get('../collab_api/categories', function(data) {
            categories = data.results;

            $.get('../collab_api/datasets/96/places', function(data) {
                L.geoJson(data.results.geoJson.features, {

                    pointToLayer: function (feature, latlng) {
                        if(typeof(categories[feature.properties.primary_category_id]) == 'undefined'){
                            return  L.marker(latlng,{});
                        }
                        return L.marker(latlng, {icon: L.icon({
                            iconUrl: "../collab_api/public/img/icons/"+categories[feature.properties.primary_category_id].i,
                            iconSize: [32, 37],
                            iconAnchor: [16, 37],
                            popupAnchor: [0, -28]
                        })});
                    },

                    onEachFeature: onEachPlace
                }).addTo(mapCategories);
            });
        });

        // mapPlacesWithinRegion ==================
        var mapPlacesWithinRegion= L.map('mapPlacesWithinRegion', {
            center: [45.50,-73.60],
            zoom: 13
        });

        var  withinBaseLayer = L.tileLayer(STAMEN_TONER_LITE_URL, {attribution: STAMEN_ATTR}).addTo(mapPlacesWithinRegion);

        $.get('../collab_api/regions/3', function(data) {
            L.geoJson(data.results.geoJson.features, {
                onEachFeature: onEachFeature
            }).addTo(mapPlacesWithinRegion);
        });

        $.get('../collab_api/places/within/3', function(data) {
            L.geoJson(data.results.geoJson.features, {
                onEachFeature: onEachPlace
            }).addTo(mapPlacesWithinRegion);
        });

     });
    </script>

  </body>
</html>
